<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="驻砖   -   住转, 转 转 驻砖.    驻  砖专转 砖.">
    <title>驻砖   - 祝 转</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <div id="branding">
                <h1><a href="index.html">锔 驻砖  </a></h1>
            </div>
            <nav>
                <ul>
                    <li class="current"><a href="index.html">祝 转</a></li>
                    <li><a href="deals.html"> </a></li>
                    <li><a href="admin.html"></a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section id="showcase">
        <div class="container">
            <h1>爪 转 驻砖 砖转 砖</h1>
            <p> 注 住转, 转 转.  砖专转  拽 砖专转 砖 转!</p>
            <a href="deals.html" class="button">爪驻  </a>
        </div>
    </section>

    <section id="featured-deals" class="container">
        <h2> 爪 </h2>
        <div id="featured-deals-list" class="deals-grid">
            <p>注  爪...</p>
        </div>
    </section>

    <footer>
        <p>驻砖   &copy; <span id="currentYear"></span></p>
    </footer>

    <script type="module">
        import { db } from './firebase-init.js';
        import { collection, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-firestore.js";

        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const featuredDealsListContainer = document.getElementById('featured-deals-list');

        async function fetchFeaturedDeals() {
            if (!featuredDealsListContainer) return;
            featuredDealsListContainer.innerHTML = '<p>注  爪...</p>'; // 注转 注

            try {
                const dealsRef = collection(db, 'deals');
                //  驻砖专 住祝 拽 专转  "爪", 砖 驻 转专 住驻  砖 'isFeatured'
                const q = query(dealsRef, orderBy('createdAt', 'desc'), limit(3)); // 爪 3  专 爪
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    featuredDealsListContainer.innerHTML = '<p> 爪  爪 专注.</p>';
                    return;
                }

                let dealsHTML = '';
                querySnapshot.forEach((doc) => {
                    const deal = doc.data();
                    const dealId = doc.id;
                    dealsHTML += `
                        <div class="deal-item">
                            <img src="${deal.imageUrl || 'https://via.placeholder.com/300x200?text=转+住专'}" alt="${deal.name}">
                            <div class="deal-item-content">
                                <h3>${deal.name}</h3>
                                <p class="price">${deal.price_text}</p>
                                <p>${deal.description.substring(0, 100)}...</p>
                                <a href="deal-details.html?dealId=${dealId}" class="button">驻专 住驻</a>
                            </div>
                        </div>
                    `;
                });
                featuredDealsListContainer.innerHTML = dealsHTML;
                // 砖 驻专住 -grid 专 注转 
                featuredDealsListContainer.id = 'deals-list'; // 砖砖 转 ID  祝  转 注爪 注拽

            } catch (error) {
                console.error("Error fetching featured deals: ", error);
                featuredDealsListContainer.innerHTML = '<p>砖 注转  爪.</p>';
            }
        }

        fetchFeaturedDeals();
    </script>
</body>
</html>
