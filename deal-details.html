<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>פרטי הדיל - נופש לי ולך</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <div id="branding">
                <h1><a href="index.html">נופש לי ולך</a></h1>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">דף הבית</a></li>
                    <li><a href="deals.html">כל הדילים</a></li>
                    <li><a href="admin.html">ניהול (מנהלים)</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section id="deal-details-page" class="container">
        <div class="deal-details-container">
            <h2 id="deal-title">טוען את פרטי הדיל...</h2>
            <img id="deal-image" src="https://via.placeholder.com/800x400?text=Deal+Image" alt="תמונת הדיל">
            <p id="deal-description">תיאור מפורט של הדיל יופיע כאן.</p>
            <p id="deal-price" class="price">מחיר: <span id="price-value"></span></p>
            <p id="deal-type">סוג דיל: <span id="type-value"></span></p>

            <div id="booking-options">
                </div>
        </div>
    </section>

    <footer>
        <p>נופש לי ולך &copy; <span id="currentYear"></span></p>
    </footer>

    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // --- התחלה: קוד JavaScript לטעינת פרטי דיל ---
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const dealId = urlParams.get('dealId');

            if (dealId) {
                // כאן תהיה לוגיקה לקריאת פרטי הדיל הספציפי מ-Firebase לפי dealId
                // או אם אין לך Backend מורכב, תוכל להעביר יותר פרמטרים ב-URL
                // או להשתמש בנתונים מדומים לצורך הדגמה:
                fetchDealDetails(dealId);
            } else {
                document.getElementById('deal-title').textContent = "דיל לא נמצא";
                document.getElementById('deal-description').textContent = "אנא חזור לדף הדילים ובחר דיל.";
            }
        });

        async function fetchDealDetails(dealId) {
            // בפועל: קריאה ל-Firebase Firestore
            // const doc = await firebase.firestore().collection('deals').doc(dealId).get();
            // if (doc.exists) {
            //    const deal = doc.data();
            //    displayDealDetails(deal);
            // } else { ... }

            // נתונים מדומים לצורך הדגמה:
            const mockDealData = {
                rhodes_example: { title: 'רודוס החל מ-100 ₪ (טיסה)', description: 'חופשה קסומה באי היווני רודוס. המחיר המוצג הוא מחיר פתיחה לטיסה הלוך ושוב לאדם. ניתן להוסיף מלון בנפרד או כחבילה. צור קשר לפרטים נוספים והצעת מחיר מותאמת אישית.', price: 'החל מ-100 ₪ לאדם', type: 'flight', imageUrl: 'https://via.placeholder.com/800x400?text=Rhodes+Deal', affiliateLinks: {} },
                barcelona_example: { title: 'ברצלונה החל מ-299 ₪ (חבילה)', description: 'חבילת נופש לברצלונה כוללת טיסות ומלון מרכזי. המחיר המוצג הוא מחיר פתיחה לחבילה לאדם. תאריכים ומלונות ניתנים להתאמה אישית.', price: 'החל מ-299 ₪ לאדם', type: 'package', imageUrl: 'https://via.placeholder.com/800x400?text=Barcelona+Package', affiliateLinks: { booking: 'YOUR_BOOKING_AFFILIATE_LINK_BARCELONA_HOTEL', agoda: 'YOUR_AGODA_AFFILIATE_LINK_BARCELONA_HOTEL' } },
                eilat_example: { title: 'אילת החל מ-120 ₪ ללילה (מלון)', description: 'מגוון מלונות באילת במחירים אטרקטיביים. הזמן ישירות דרך הקישורים שלנו או פנה אלינו לסגירה אישית וקבלת ייעוץ.', price: 'החל מ-120 ₪ ללילה', type: 'hotel', imageUrl: 'https://via.placeholder.com/800x400?text=Eilat+Hotel+Deal', affiliateLinks: { booking: 'YOUR_BOOKING_AFFILIATE_LINK_EILAT', agoda: 'YOUR_AGODA_AFFILIATE_LINK_EILAT', expedia: 'YOUR_EXPEDIA_AFFILIATE_LINK_EILAT' } },
                rome_flight_example: { title: 'טיסה לרומא החל מ-150 €', description: 'טיסות זולות לרומא! המחיר המוצג הוא לכיוון אחד או הלוך ושוב בהתאם למבצעים. צור קשר לקבלת ההצעה הטובה ביותר עבורך.', price: 'החל מ-150 €', type: 'flight', imageUrl: 'https://via.placeholder.com/800x400?text=Rome+Flight+Deal', affiliateLinks: {} }
            };

            const deal = mockDealData[dealId]; // החלף בנתונים אמיתיים

            if (deal) {
                document.getElementById('deal-title').textContent = deal.title;
                document.getElementById('deal-image').src = deal.imageUrl;
                document.getElementById('deal-image').alt = deal.title;
                document.getElementById('deal-description').textContent = deal.description;
                document.getElementById('price-value').textContent = deal.price;
                document.getElementById('type-value').textContent = getDealTypeDisplay(deal.type);

                const bookingOptionsContainer = document.getElementById('booking-options');
                bookingOptionsContainer.innerHTML = ''; // נקה אפשרויות קודמות

                if (deal.type === 'flight') {
                    bookingOptionsContainer.innerHTML = `
                        <p>להזמנת טיסה זו, אנא פנה אלינו ישירות. אנו נסגור עבורך את ההזמנה בעמלה של 100 ₪ או 5% ממחיר הטיסה (הנמוך מביניהם).</p>
                        <a href="mailto:your-email@example.com?subject=הזמנת טיסה ל${deal.title}" class="button">פנה אליי לסגירת ההזמנה</a>
                    `;
                } else if (deal.type === 'hotel') {
                    let affiliateButtonsHTML = '';
                    if (deal.affiliateLinks.booking) {
                        affiliateButtonsHTML += `<a href="${deal.affiliateLinks.booking}" target="_blank" class="button">הזמן לבד דרך Booking.com</a>`;
                    }
                    if (deal.affiliateLinks.agoda) {
                        affiliateButtonsHTML += `<a href="${deal.affiliateLinks.agoda}" target="_blank" class="button button-secondary">הזמן לבד דרך Agoda</a>`;
                    }
                    if (deal.affiliateLinks.expedia) {
                        affiliateButtonsHTML += `<a href="${deal.affiliateLinks.expedia}" target="_blank" class="button">הזמן לבד דרך Expedia</a>`;
                    }

                    bookingOptionsContainer.innerHTML = `
                        <p><strong>אפשרות 1: הזמנה עצמאית (ואנחנו מקבלים עמלה קטנה מהשותפים)</strong></p>
                        ${affiliateButtonsHTML || '<p>אין כרגע קישורי שותפים זמינים למלון זה.</p>'}
                        <hr style="margin: 20px 0;">
                        <p><strong>אפשרות 2: שירות אישי שלנו</strong></p>
                        <p>פנה אלינו לסגירה אישית של המלון בעמלה של 100 ₪ או 5% ממחיר המלון (הנמוך מביניהם).</p>
                        <a href="mailto:your-email@example.com?subject=הזמנת מלון: ${deal.title}" class="button">בקש ממני לסגור לך</a>
                    `;
                } else if (deal.type === 'package') {
                     bookingOptionsContainer.innerHTML = `
                        <p>להזמנת חבילה זו (טיסה + מלון), אנא פנה אלינו ישירות. אנו נסגור עבורך את ההזמנה בעמלה כוללת של 100 ₪ או 5% מהמחיר הכולל של החבילה.</p>
                        <a href="mailto:your-email@example.com?subject=הזמנת חבילה: ${deal.title}" class="button">פנה אליי לסגירת החבילה</a>
                    `;
                }

            } else {
                document.getElementById('deal-title').textContent = "דיל לא נמצא";
                document.getElementById('deal-description').textContent = "לא הצלחנו למצוא את פרטי הדיל המבוקש.";
                document.getElementById('deal-image').style.display = 'none';
            }
        }

        function getDealTypeDisplay(typeKey) {
            if (typeKey === 'flight') return 'טיסה';
            if (typeKey === 'hotel') return 'מלון';
            if (typeKey === 'package') return 'חבילה';
            return typeKey;
        }
        // --- סוף: קוד JavaScript לטעינת פרטי דיל ---
    </script>
</body>
</html>
